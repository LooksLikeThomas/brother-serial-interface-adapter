@startuml Typewriter_Transmission_Phases_Final
hide time-axis
title Typewriter Initiates Transmission
footer Typewriter (T) / Interface (I)

<style>
timingDiagram {
  .signal {
    LineColor black
  }
  concise {
    LineColor black
    BackgroundColor white
    FontSize 12
  }
  /* Apply to ALL robust signals: White text hides the labels */
  robust {
    LineColor black
    BackgroundColor white
    FontColor white
  }
  arrow {
    LineColor blue
  }
  constraintArrow {
    LineThickness 1
    LineColor black
    FontColor black
  }
  timegrid {
    LineColor transparent
  }
}
</style>

scale 5 as 100 pixels

' Define Participants - All converted to robust
robust "KBRQ (T)" as KBRQ
robust "READY (I)" as READY
robust "KBACK (T)" as KBACK 
robust "SCK (I)" as SCK
robust "SO (T)" as SO
robust "SI (I)" as SI
concise "Protocol Phase" as Phase 

' --- State Definitions ---

KBRQ has high,low
READY has high,low
KBACK has high,low
SCK has high,low
SO has high,low
SI has high,low

' --- State Definitions ---

@0
Phase is {-}
KBRQ is low
READY is high
KBACK is low
SCK is high
SO is low
SI is high

@5
Phase is "SYN"
KBRQ is high
KBACK is high
SO is high

@10
Phase is "ACK"
READY is low
KBRQ is low

@15
Phase is "TRANSFER"
SCK is low
KBACK is low
SO is low

@16
SCK is high

@17
SCK is low
SO is high

@18
SCK is high

@19
SCK is low
SO is low

@20
SCK is high

@21
SCK is low
SO is high

@22
SCK is high

@23
SCK is low
SO is low

@24
SCK is high

@25
SCK is low
SO is high

@26
SCK is high

@27
SCK is low
SO is low

@28
SCK is high

@29
SCK is low
SO is high

@30

SCK is high
SI is high

@31
Phase is "BUSY"

@38
Phase is "FIN"
READY is high
KBRQ is high
SO is low
SO is low

@40
Phase is {-}
KBRQ is low

' Adjusted start time to 5 units
Phase@5 <-> @10 : ~100us
Phase@10 <-> @15 : ~200us
Phase@15 <-> @31 : ~100us
Phase@31 <-> @38 : ~240us
Phase@38 <-> @40 : ~10us

' --- Highlighting ---
' Grey with ~10% opacity (approx hex #E6E6E6 or using alpha if supported, standard light grey is safest)
highlight 5 to 15 #EEEEEE;line:DimGrey : Connection
highlight 15 to 31 #EEEEEE;line:DimGrey : Serial data bits ASCII "U" (MSB)
highlight 31 to 40 #EEEEEE;line:DimGrey : Termination


@enduml